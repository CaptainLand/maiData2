{"version":3,"file":"js/548.28b5a7e4.js","mappings":"wGACA,IAAIA,EAAI,EAAQ,MACZC,EAAO,EAAQ,MACfC,EAAY,EAAQ,MACpBC,EAAW,EAAQ,MACnBC,EAAoB,EAAQ,MAC5BC,EAAyB,EAAQ,MACjCC,EAAsB,EAAQ,MAC9BC,EAAgB,EAAQ,MACxBC,EAAU,EAAQ,MAClBC,EAA2C,EAAQ,MAEnDC,GAAqCF,GAAWC,EAAyC,UAAWE,WAEpGC,EAAgBN,GAAoB,WACtC,IAEIO,EAAQC,EAFRC,EAAWC,KAAKD,SAChBE,EAASD,KAAKC,OAGlB,MAAO,EAAM,CACX,GAAIH,EAAQE,KAAKF,MAAO,IAEtB,GADAD,EAASV,EAASF,EAAKa,EAAMI,KAAMJ,EAAMC,YACpCF,EAAOM,KAAM,OAAON,EAAOO,MAChCJ,KAAKF,MAAQ,IACf,CAAE,MAAOO,GAASd,EAAcQ,EAAU,QAASM,EAAQ,CAI3D,GAFAR,EAASV,EAASF,EAAKe,KAAKE,KAAMH,IAE9BC,KAAKG,OAASN,EAAOM,KAAM,OAE/B,IACEH,KAAKF,MAAQT,EAAuBY,EAAOJ,EAAOO,MAAOJ,KAAKM,YAAY,EAC5E,CAAE,MAAOD,GAASd,EAAcQ,EAAU,QAASM,EAAQ,CAC7D,CACF,IAIArB,EAAE,CAAEuB,OAAQ,WAAYC,OAAO,EAAMC,MAAM,EAAMC,OAAQlB,GAAWE,GAAqC,CACvGiB,QAAS,SAAiBV,GACxBd,EAASa,MACT,IACEd,EAAUe,EACZ,CAAE,MAAOI,GACPd,EAAcS,KAAM,QAASK,EAC/B,CAEA,OAAIX,EAA0CT,EAAKS,EAAmCM,KAAMC,GAErF,IAAIL,EAAcR,EAAkBY,MAAO,CAChDC,OAAQA,EACRH,MAAO,MAEX,G,kHCpDIc,MAAM,qB,GAEHA,MAAM,W,GAEJA,MAAM,uB,GAKNA,MAAM,kB,GAVjBC,IAAA,EAY0CD,MAAM,iB,GAZhDC,IAAA,EAyBoBD,MAAM,c,0EAxBzBE,EAAAA,EAAAA,IA6BO,MA7BPC,EA6BO,cA5BJC,EAAAA,EAAAA,IAA8B,OAAzBJ,MAAM,cAAY,WACvBI,EAAAA,EAAAA,IA0BM,MA1BNC,EA0BM,EAzBJD,EAAAA,EAAAA,IAAsD,WAAAE,EAAAA,EAAAA,IAA/CC,EAAAC,KAAKC,OAAQ,OAAGH,EAAAA,EAAAA,IAAGC,EAAAG,eAAeC,OAAK,IAC9CP,EAAAA,EAAAA,IAIM,MAJNQ,EAIM,EAHJR,EAAAA,EAAAA,IAAgF,uBAA7EA,EAAAA,EAAAA,IAAoB,cAAZ,OAAG,KANtBS,EAAAA,EAAAA,IAM+B,KAACP,EAAAA,EAAAA,IAAGC,EAAAG,eAAeC,OAAQ,MAAEL,EAAAA,EAAAA,IAAGC,EAAAG,eAAeI,IAAK,IAAC,MAC5EV,EAAAA,EAAAA,IAAwD,uBAArDA,EAAAA,EAAAA,IAAoB,cAAZ,OAAG,KAPtBS,EAAAA,EAAAA,IAO+B,KAACP,EAAAA,EAAAA,IAAGC,EAAAG,eAAeK,SAAO,MACjDX,EAAAA,EAAAA,IAAmE,uBAAhEA,EAAAA,EAAAA,IAAuB,cAAf,UAAM,KARzBS,EAAAA,EAAAA,IAQkC,KAACP,EAAAA,EAAAA,IAAGC,EAAAG,eAAeM,MAAMC,KAAK,MAAD,QAEzDb,EAAAA,EAAAA,IAkBM,MAlBNc,EAkBM,cAjBJd,EAAAA,EAAAA,IAAsC,UAAlC,iCAA6B,IACtBG,EAAAY,WAAWC,OAAS,IAAH,WAA5BlB,EAAAA,EAAAA,IAYM,MAZNmB,EAYM,EAXJC,EAAAA,EAAAA,IAUEC,EAAA,CATCC,QAAS,CAAC,KAAM,KAAM,MAAO,KAAM,OAAQ,QAC3CC,KAAMlB,EAAAY,WAAWO,KAAI,CAACC,EAAGC,IAAM,CAAiBA,EAAC,EAAsBD,EAAEE,YAAW,GAAqBF,EAAEG,aAAaC,QAAO,MAAwBC,EAAAC,WAAWN,EAAEO,MAAuBP,EAAEQ,IAAE,IAAyBR,EAAES,Y,iCAU/NlC,EAAAA,EAAAA,IAEM,MAFNmC,EAEMC,EAAA,KAAAA,EAAA,KADJlC,EAAAA,EAAAA,IAAe,SAAZ,YAAQ,Y,mzgRAYrB,GACEmC,KAAM,2BACNC,WAAY,CACVC,YAAWA,EAAAA,GAEbhB,IAAAA,GACE,MAAO,CACLjB,KAAM,KACNE,eAAgB,KAChBS,WAAY,GACZuB,SAAS,EACTjD,MAAO,KAEX,EACA,aAAMkD,GACJ,MAAMC,EAASxD,KAAKyD,OAAOC,OAAOC,GAC5BC,EAAaC,SAAS7D,KAAKyD,OAAOC,OAAOE,YAG/C5D,KAAKoB,KAAO0C,EAAUC,MAAK3C,GAAQA,EAAKuC,KAAOH,IAC1CxD,KAAKoB,KAMNwC,EAAa,GAAKA,GAAc5D,KAAKoB,KAAKG,MAAMS,OAChDhC,KAAKK,MAAQ,WAIjBL,KAAKsB,eAAiB,CAClBC,MAAOvB,KAAKoB,KAAKG,MAAMqC,GACvBlC,GAAI1B,KAAKoB,KAAKM,GAAGkC,GACjBjC,QAAS3B,KAAKoB,KAAK4C,OAAOJ,GAAYjC,QACtCC,MAAO5B,KAAKoB,KAAK4C,OAAOJ,GAAYhC,OAIxC5B,KAAKiE,WAAaC,EAAAA,GAAgBC,QAAOC,GACvCA,EAAOC,UAAYb,GAAUY,EAAOE,cAAgBV,UAGhD5D,KAAKuE,gBAtBPvE,KAAKK,MAAQ,SAuBnB,EACAmE,QAAS,CACP3B,UAAAA,CAAWC,GACT,OAAKA,EACEA,EAAK2B,QAAQ,KAAM,MACfA,QAAQ,MAAO,OACfA,QAAQ,OAAQ,QAHT,KAIpB,EACA,kBAAMF,GACJvE,KAAKsD,SAAU,EACftD,KAAKK,MAAQ,KAEb,IACE,MAAMqE,QAAiBC,MACrB,sDAAsD3E,KAAKyD,OAAOC,OAAOC,kBAAkBE,SAAS7D,KAAKyD,OAAOC,OAAOE,eAGzH,IAAKc,EAASE,GACZ,MAAM,IAAIC,MAAM,SAASH,EAASI,UAGpC,MAAMzC,QAAaqC,EAASK,OAC5BC,QAAQC,IAAI,WAAY5C,GAGxBrC,KAAK+B,WAAaM,EAAKA,KAAK1B,SAAQuE,IAC1BA,EAAOC,SAAW,IAAIhB,QAAOC,GACnCA,EAAOC,SAAWrE,KAAKyD,OAAOC,OAAOC,IACrCS,EAAOE,cAAgBT,SAAS7D,KAAKyD,OAAOC,OAAOE,cACnDtB,KAAI8B,IAAK,CACT3B,YAAayC,EAAOE,UAAYF,EAAOG,SACvC3C,aAAc0B,EAAO1B,cAAgB,EACrCI,KAAMsB,EAAOtB,MAAQ,MACrBC,GAAIqB,EAAOrB,IAAM,IACjBC,QAASoB,EAAOpB,SAAW,EAC3BsC,OAAQ,YAETC,MAAK,CAACC,EAAGC,IAAMA,EAAE/C,aAAe8C,EAAE9C,cAEvC,CAAE,MAAOrC,GACPL,KAAKK,MAAQ,aAAaA,EAAMqF,SAClC,CAAE,QACA1F,KAAKsD,SAAU,CACjB,CACF,I,UCvHJ,MAAMqC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAEzF,O,uBCRA,IAAI3G,EAAO,EAAQ,MACfE,EAAW,EAAQ,MACnBC,EAAoB,EAAQ,MAC5ByG,EAAoB,EAAQ,KAEhCC,EAAOC,QAAU,SAAUC,EAAKC,GACzBA,GAAiC,kBAARD,GAAkB7G,EAAS6G,GACzD,IAAIE,EAASL,EAAkBG,GAC/B,OAAO5G,EAAkBD,OAAoBgH,IAAXD,EAAuBjH,EAAKiH,EAAQF,GAAOA,GAC/E,C","sources":["webpack://test2/./node_modules/core-js/modules/es.iterator.flat-map.js","webpack://test2/./src/views/SongDifficultyDetailView.vue","webpack://test2/./src/views/SongDifficultyDetailView.vue?ac2f","webpack://test2/./node_modules/core-js/internals/get-iterator-flattenable.js"],"sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar call = require('../internals/function-call');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar getIteratorFlattenable = require('../internals/get-iterator-flattenable');\nvar createIteratorProxy = require('../internals/iterator-create-proxy');\nvar iteratorClose = require('../internals/iterator-close');\nvar IS_PURE = require('../internals/is-pure');\nvar iteratorHelperWithoutClosingOnEarlyError = require('../internals/iterator-helper-without-closing-on-early-error');\n\nvar flatMapWithoutClosingOnEarlyError = !IS_PURE && iteratorHelperWithoutClosingOnEarlyError('flatMap', TypeError);\n\nvar IteratorProxy = createIteratorProxy(function () {\n  var iterator = this.iterator;\n  var mapper = this.mapper;\n  var result, inner;\n\n  while (true) {\n    if (inner = this.inner) try {\n      result = anObject(call(inner.next, inner.iterator));\n      if (!result.done) return result.value;\n      this.inner = null;\n    } catch (error) { iteratorClose(iterator, 'throw', error); }\n\n    result = anObject(call(this.next, iterator));\n\n    if (this.done = !!result.done) return;\n\n    try {\n      this.inner = getIteratorFlattenable(mapper(result.value, this.counter++), false);\n    } catch (error) { iteratorClose(iterator, 'throw', error); }\n  }\n});\n\n// `Iterator.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.flatmap\n$({ target: 'Iterator', proto: true, real: true, forced: IS_PURE || flatMapWithoutClosingOnEarlyError }, {\n  flatMap: function flatMap(mapper) {\n    anObject(this);\n    try {\n      aCallable(mapper);\n    } catch (error) {\n      iteratorClose(this, 'throw', error);\n    }\n\n    if (flatMapWithoutClosingOnEarlyError) return call(flatMapWithoutClosingOnEarlyError, this, mapper);\n\n    return new IteratorProxy(getIteratorDirect(this), {\n      mapper: mapper,\n      inner: null\n    });\n  }\n});\n","<template>\r\n <div class=\"difficulty-detail\">\r\n    <div class=\"background\"></div>\r\n    <div class=\"content\">\r\n      <h1>{{ song.title }} - {{ difficultyInfo.level }}</h1>\r\n      <div class=\"song-info btn-style\">\r\n        <p><strong>难度:</strong> {{ difficultyInfo.level }} ({{ difficultyInfo.ds }})</p>\r\n        <p><strong>谱师:</strong> {{ difficultyInfo.charter }}</p>\r\n        <p><strong>Note数:</strong> {{ difficultyInfo.notes.join('/') }}</p>\r\n      </div>\r\n      <div class=\"player-records\">\r\n        <h2>玩家成绩排行(仅收录已上传import-token的玩家)</h2>\r\n        <div v-if=\"allRecords.length > 0\" class=\"records-table\">\r\n          <StyledTable\r\n            :headers=\"['排名', '玩家', '达成率', '评级', 'FC状态', 'DX分数']\"\r\n            :data=\"allRecords.map((r, i) => [\r\n              i + 1, \r\n              r.player_name, \r\n              `${r.achievements.toFixed(2)}%`, \r\n              formatRate(r.rate), \r\n              r.fc || '无', \r\n              r.dxScore\r\n            ])\"\r\n          />\r\n        </div>\r\n        <div v-else class=\"no-records\">\r\n          <p>暂无玩家成绩记录</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport songsData from '@/assets/songs.json';\r\nimport lanData from '@/assets/lan.json';\r\nimport StyledTable from '@/components/StyledTable.vue';\r\n\r\nexport default {\r\n  name: 'SongDifficultyDetailView',\r\n  components: {\r\n    StyledTable\r\n  },\r\n  data() {\r\n    return {\r\n      song: null,\r\n      difficultyInfo: null,\r\n      allRecords: [],\r\n      loading: false,\r\n      error: null\r\n    }\r\n  },\r\n  async created() {\r\n    const songId = this.$route.params.id;\r\n    const levelIndex = parseInt(this.$route.params.levelIndex);\r\n    \r\n    // 确保song_id和level_index正确匹配\r\n    this.song = songsData.find(song => song.id === songId);\r\n    if (!this.song) {\r\n        this.error = '未找到指定歌曲';\r\n        return;\r\n    }\r\n    \r\n    // 确保levelIndex在有效范围内\r\n    if (levelIndex < 0 || levelIndex >= this.song.level.length) {\r\n        this.error = '无效的难度等级';\r\n        return;\r\n    }\r\n    \r\n    this.difficultyInfo = {\r\n        level: this.song.level[levelIndex],\r\n        ds: this.song.ds[levelIndex],\r\n        charter: this.song.charts[levelIndex].charter,\r\n        notes: this.song.charts[levelIndex].notes\r\n    };\r\n    \r\n    // 从lan.json获取测试数据\r\n    this.lanRecords = lanData.records.filter(record => \r\n      record.song_id === songId && record.level_index === levelIndex\r\n    );\r\n    \r\n    await this.fetchRecords();\r\n  },\r\n  methods: {\r\n    formatRate(rate) {\r\n      if (!rate) return 'N/A';\r\n      return rate.replace('sp', 's+')\r\n                .replace('ssp', 'ss+')\r\n                .replace('sssp', 'sss+');\r\n    },\r\n    async fetchRecords() {\r\n      this.loading = true;\r\n      this.error = null;\r\n      \r\n      try {\r\n        const response = await fetch(\r\n          `https://h45a9mxjzl.hzh.sealos.run/get-data?song_id=${this.$route.params.id}&level_index=${parseInt(this.$route.params.levelIndex)}`\r\n        );\r\n        \r\n        if (!response.ok) {\r\n          throw new Error(`请求失败: ${response.status}`);\r\n        }\r\n        \r\n        const data = await response.json();\r\n        console.log('API返回数据:', data);\r\n        \r\n        // 从每个玩家的records中提取匹配当前歌曲和难度的记录\r\n        this.allRecords = data.data.flatMap(player => {\r\n          return (player.records || []).filter(record => \r\n            record.song_id == this.$route.params.id && \r\n            record.level_index === parseInt(this.$route.params.levelIndex)\r\n          ).map(record => ({\r\n            player_name: player.nickname || player.username,\r\n            achievements: record.achievements || 0,\r\n            rate: record.rate || 'N/A',\r\n            fc: record.fc || '无',\r\n            dxScore: record.dxScore || 0,\r\n            source: 'API'\r\n          }));\r\n        }).sort((a, b) => b.achievements - a.achievements);\r\n        \r\n      } catch (error) {\r\n        this.error = `获取成绩数据失败: ${error.message}`;\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.difficulty-detail {\r\n  position: relative;\r\n  min-height: 100vh;\r\n  padding: 20px;\r\n}\r\n\r\n.background {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: url('@/assets/bg.jpg') no-repeat center center;\r\n  background-size: cover;\r\n  filter: brightness(0.7);\r\n  z-index: -1;\r\n}\r\n\r\n.content {\r\n  position: relative;\r\n  z-index: 1;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n.btn-style {\r\n  padding: 1.5rem;\r\n  border-radius: 15px;\r\n  margin-bottom: 1.5rem;\r\n  transition: all 0.3s ease;\r\n  box-shadow: 0 4px 15px rgba(0,0,0,0.3);\r\n  background: rgba(150, 248, 252, 0.2);\r\n  backdrop-filter: blur(10px);\r\n  border: 2px solid rgba(150, 248, 252, 0.3);\r\n  color: white;\r\n}\r\n\r\n.btn-style:hover {\r\n  transform: translateY(-3px);\r\n  box-shadow: 0 6px 20px rgba(0,0,0,0.4);\r\n  background: rgba(150, 248, 252, 0.3);\r\n}\r\n\r\n.player-records {\r\n  margin-top: 20px;\r\n}\r\n\r\n.no-records {\r\n  text-align: center;\r\n  padding: 20px;\r\n  color: #666;\r\n}\r\n</style>","import { render } from \"./SongDifficultyDetailView.vue?vue&type=template&id=7b9c95c2&scoped=true\"\nimport script from \"./SongDifficultyDetailView.vue?vue&type=script&lang=js\"\nexport * from \"./SongDifficultyDetailView.vue?vue&type=script&lang=js\"\n\nimport \"./SongDifficultyDetailView.vue?vue&type=style&index=0&id=7b9c95c2&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7b9c95c2\"]])\n\nexport default __exports__","'use strict';\nvar call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nmodule.exports = function (obj, stringHandling) {\n  if (!stringHandling || typeof obj !== 'string') anObject(obj);\n  var method = getIteratorMethod(obj);\n  return getIteratorDirect(anObject(method !== undefined ? call(method, obj) : obj));\n};\n"],"names":["$","call","aCallable","anObject","getIteratorDirect","getIteratorFlattenable","createIteratorProxy","iteratorClose","IS_PURE","iteratorHelperWithoutClosingOnEarlyError","flatMapWithoutClosingOnEarlyError","TypeError","IteratorProxy","result","inner","iterator","this","mapper","next","done","value","error","counter","target","proto","real","forced","flatMap","class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","$data","song","title","difficultyInfo","level","_hoisted_3","_createTextVNode","ds","charter","notes","join","_hoisted_4","allRecords","length","_hoisted_5","_createVNode","_component_StyledTable","headers","data","map","r","i","player_name","achievements","toFixed","$options","formatRate","rate","fc","dxScore","_hoisted_6","_cache","name","components","StyledTable","loading","created","songId","$route","params","id","levelIndex","parseInt","songsData","find","charts","lanRecords","lanData","filter","record","song_id","level_index","fetchRecords","methods","replace","response","fetch","ok","Error","status","json","console","log","player","records","nickname","username","source","sort","a","b","message","__exports__","render","getIteratorMethod","module","exports","obj","stringHandling","method","undefined"],"sourceRoot":""}